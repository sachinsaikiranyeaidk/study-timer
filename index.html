<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Autodidactic - Study Timer</title>
<style>
  :root {
    --navy: #0b2342;
    --black: #000000;
    --blue: #0074d9;
    --dark-black-blue: #001a33;
    --white: #ffffff;
    --gray-light: #ccc;
    --gray-dark: #333;
    --text-transparent: rgba(255,255,255,0.15);
  }

  body {
    margin: 0; padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--navy);
    color: var(--white);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  header {
    padding: 12px 20px;
    text-align: center;
    font-weight: 900;
    font-size: 1.8rem;
    user-select: none;
    letter-spacing: 0.06em;
  }

  #controls {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
    margin: 10px auto 0;
  }

  button, select {
    padding: 8px 12px;
    font-size: 1rem;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }

  button:hover, select:hover {
    background-color: var(--blue);
    color: var(--white);
  }

  button:active {
    transform: scale(0.97);
  }

  #timer-container {
    max-width: 360px;
    margin: 20px auto;
    text-align: center;
    position: relative;
  }

  #time-circle {
    width: 320px;
    height: 320px;
    margin: 0 auto;
    position: relative;
  }

  svg {
    transform: rotate(-90deg);
    width: 320px;
    height: 320px;
  }

  circle {
    fill: none;
    stroke-width: 18;
    stroke-linecap: round;
  }

  #background-circle {
    stroke: var(--gray-dark);
  }

  #progress-circle {
    stroke: var(--blue);
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    transition: stroke-dashoffset 0.3s linear;
  }

  #time-display {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-size: 4.5rem;
    font-weight: 800;
    user-select: none;
  }

  #status-text {
    margin-top: 10px;
    font-size: 1.4rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    user-select: none;
  }

  #task-section {
    max-width: 480px;
    margin: 30px auto 0;
    background: rgba(255 255 255 / 0.1);
    border-radius: 12px;
    padding: 20px;
  }

  #task-list {
    list-style: none;
    padding: 0;
    margin: 0 0 15px;
    max-height: 180px;
    overflow-y: auto;
  }

  #task-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(255 255 255 / 0.15);
    margin-bottom: 8px;
    padding: 10px 14px;
    border-radius: 6px;
    font-weight: 600;
  }

  #task-list li span {
    flex-grow: 1;
    user-select: text;
  }

  #task-list li button {
    background: #ff3b3b;
    border: none;
    color: white;
    font-weight: 700;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }

  #task-list li button:hover {
    background: #d23232;
  }

  #add-task-form {
    display: flex;
    gap: 10px;
  }

  #add-task-form input[type="text"] {
    flex-grow: 1;
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    font-size: 1rem;
  }

  #add-task-form button {
    background: var(--blue);
    color: white;
    font-weight: 700;
    border: none;
    border-radius: 6px;
    padding: 8px 16px;
    cursor: pointer;
  }

  #add-task-form button:hover {
    background: #005bb5;
  }

  #man-hours {
    text-align: center;
    margin-top: 20px;
    font-size: 1.2rem;
    user-select: none;
    font-weight: 600;
  }

  #footer-credit {
    position: fixed;
    bottom: 8px;
    right: 10px;
    font-size: 0.85rem;
    color: var(--text-transparent);
    user-select: none;
    pointer-events: none;
    font-family: monospace;
    letter-spacing: 0.04em;
  }

  /* Dark/light mode toggle style */
  #dark-light-toggle {
    font-weight: 600;
  }

  /* Sound toggle button style */
  #sound-toggle {
    font-weight: 600;
  }

  /* Background color selector style */
  #bg-select {
    font-weight: 600;
  }

</style>
</head>
<body>
<header>autodidactic - study timer</header>

<div id="controls">
  <button id="start-pause-btn">Start</button>
  <button id="reset-btn">Reset</button>
  <button id="sound-toggle" title="Toggle Alarm Sound">üîä On</button>
  <label for="dark-light-toggle" style="align-self:center;user-select:none;">üåô / ‚òÄÔ∏è</label>
  <input type="checkbox" id="dark-light-toggle" />
  <select id="bg-select" title="Select Background Color">
    <option value="navy" selected>Navy</option>
    <option value="black">Black</option>
    <option value="blue">Blue</option>
    <option value="dark-black-blue">Dark Black Blue</option>
  </select>
</div>

<div id="timer-container">
  <div id="time-circle">
    <svg>
      <circle id="background-circle" cx="160" cy="160" r="150"></circle>
      <circle id="progress-circle" cx="160" cy="160" r="150"></circle>
    </svg>
    <div id="time-display">25:00</div>
  </div>
  <div id="status-text">Work</div>
</div>

<div id="task-section">
  <ul id="task-list"></ul>
  <form id="add-task-form">
    <input type="text" id="task-input" placeholder="Add new task..." maxlength="50" autocomplete="off" required />
    <button type="submit">Add</button>
  </form>
</div>

<div id="man-hours">Man Hours Studied: 0m</div>

<div id="footer-credit">Created by Sachin Saikiran</div>

<script>
  (() => {
    const WORK_MINUTES_DEFAULT = 25;
    const BREAK_MINUTES_DEFAULT = 5;

    // State
    let isRunning = false;
    let isWorkSession = true;
    let workMinutes = WORK_MINUTES_DEFAULT;
    let breakMinutes = BREAK_MINUTES_DEFAULT;
    let secondsLeft = workMinutes * 60;
    let intervalId = null;
    let soundOn = true;
    let manSeconds = 0;

    // Elements
    const startPauseBtn = document.getElementById('start-pause-btn');
    const resetBtn = document.getElementById('reset-btn');
    const timeDisplay = document.getElementById('time-display');
    const statusText = document.getElementById('status-text');
    const progressCircle = document.getElementById('progress-circle');
    const soundToggleBtn = document.getElementById('sound-toggle');
    const darkLightToggle = document.getElementById('dark-light-toggle');
    const bgSelect = document.getElementById('bg-select');
    const manHoursDisplay = document.getElementById('man-hours');
    const taskListEl = document.getElementById('task-list');
    const addTaskForm = document.getElementById('add-task-form');
    const taskInput = document.getElementById('task-input');
    const body = document.body;

    // Sound alarm (simple beep)
    const alarmSound = new Audio();
    alarmSound.src = "data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA="; // silent short clip placeholder

    // For actual beep, let's create a short beep tone using Web Audio API
    function playBeep() {
      if (!soundOn) return;
      const ctx = new AudioContext();
      const oscillator = ctx.createOscillator();
      oscillator.type = 'square';
      oscillator.frequency.setValueAtTime(1000, ctx.currentTime);
      oscillator.connect(ctx.destination);
      oscillator.start();
      oscillator.stop(ctx.currentTime + 0.15);
      oscillator.onended = () => ctx.close();
    }

    // Convert seconds to MM:SS
    function formatTime(sec) {
      const m = Math.floor(sec / 60);
      const s = sec % 60;
      return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }

    // Update circle progress
    function updateProgressCircle() {
      const totalSeconds = isWorkSession ? workMinutes * 60 : breakMinutes * 60;
      const percent = secondsLeft / totalSeconds;
      const circumference = 2 * Math.PI * 150;
      const offset = circumference * (1 - percent);
      progressCircle.style.strokeDashoffset = offset;
    }

    // Update UI
    function updateUI() {
      timeDisplay.textContent = formatTime(secondsLeft);
      statusText.textContent = isWorkSession ? 'Work' : 'Break';
      updateProgressCircle();
      startPauseBtn.textContent = isRunning ? 'Pause' : 'Start';
    }

    // Timer tick
    function tick() {
      if (secondsLeft > 0) {
        secondsLeft--;
        manSeconds++;
        updateManHoursDisplay();
        updateUI();
      } else {
        playBeep();
        isWorkSession = !isWorkSession;
        secondsLeft = (isWorkSession ? workMinutes : breakMinutes) * 60;
        updateUI();
      }
    }

    // Start timer
    function startTimer() {
      if (isRunning) return;
      isRunning = true;
      intervalId = setInterval(tick, 1000);
      updateUI();
    }

    // Pause timer
    function pauseTimer() {
      if (!isRunning) return;
      isRunning = false;
      clearInterval(intervalId);
      updateUI();
    }

    // Reset timer
    function resetTimer() {
      pauseTimer();
      isWorkSession = true;
      secondsLeft = workMinutes * 60;
      manSeconds = 0;
      updateManHoursDisplay();
      updateUI();
    }

    // Update man hours display
    function updateManHoursDisplay() {
      const m = Math.floor(manSeconds / 60);
      const s = manSeconds % 60;
      manHoursDisplay.textContent = `Man Hours Studied: ${m}m ${s}s`;
    }

    // Toggle sound
    soundToggleBtn.addEventListener('click', () => {
      soundOn = !soundOn;
      soundToggleBtn.textContent = soundOn ? 'üîä On' : 'üîá Off';
    });

    // Dark/light mode toggle
    darkLightToggle.addEventListener('change', () => {
      if (darkLightToggle.checked) {
        body.style.backgroundColor = '#fefefe';
        body.style.color = '#222';
        // update circle colors for light mode
        document.getElementById('background-circle').style.stroke = '#ddd';
        progressCircle.style.stroke = '#0074d9';
        statusText.style.color = '#222';
      } else {
        // revert to chosen bg color below
        setBackgroundColor(bgSelect.value);
        statusText.style.color = 'white';
      }
    });

    // Background color selector
    function setBackgroundColor(color) {
      switch(color) {
        case 'navy':
          body.style.backgroundColor = '#0b2342';
          body.style.color = 'white';
          document.getElementById('background-circle').style.stroke = 'rgba(255,255,255,0.15)';
          progressCircle.style.stroke = '#0074d9';
          break;
        case 'black':
          body.style.backgroundColor = '#000000';
          body.style.color = 'white';
          document.getElementById('background-circle').style.stroke = 'rgba(255,255,255,0.1)';
          progressCircle.style.stroke = '#3399ff';
          break;
        case 'blue':
          body.style.backgroundColor = '#0074d9';
          body.style.color = 'white';
          document.getElementById('background-circle').style.stroke = 'rgba(255,255,255,0.2)';
          progressCircle.style.stroke = '#001f3f';
          break;
        case 'dark-black-blue':
          body.style.backgroundColor = '#001a33';
          body.style.color = 'white';
          document.getElementById('background-circle').style.stroke = 'rgba(255,255,255,0.1)';
          progressCircle.style.stroke = '#66a3ff';
          break;
        default:
          body.style.backgroundColor = '#0b2342';
          body.style.color = 'white';
          document.getElementById('background-circle').style.stroke = 'rgba(255,255,255,0.15)';
          progressCircle.style.stroke = '#0074d9';
      }
    }

    bgSelect.addEventListener('change', () => {
      if (!darkLightToggle.checked) {
        setBackgroundColor(bgSelect.value);
      }
    });

    // Start/pause button
    startPauseBtn.addEventListener('click', () => {
      if (isRunning) {
        pauseTimer();
      } else {
        startTimer();
      }
    });

    // Reset button
    resetBtn.addEventListener('click', resetTimer);

    // Tasks handling
    let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

    function saveTasks() {
      localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    function renderTasks() {
      taskListEl.innerHTML = '';
      if (tasks.length === 0) {
        const emptyMsg = document.createElement('li');
        emptyMsg.style.justifyContent = 'center';
        emptyMsg.style.fontWeight = '400';
        emptyMsg.textContent = 'No tasks added yet.';
        taskListEl.appendChild(emptyMsg);
        return;
      }
      tasks.forEach((task, i) => {
        const li = document.createElement('li');
        const span = document.createElement('span');
        span.textContent = task;
        li.appendChild(span);
        const delBtn = document.createElement('button');
        delBtn.textContent = 'Delete';
        delBtn.title = 'Delete task';
        delBtn.addEventListener('click', () => {
          tasks.splice(i, 1);
          saveTasks();
          renderTasks();
        });
        li.appendChild(delBtn);
        taskListEl.appendChild(li);
      });
    }

    addTaskForm.addEventListener('submit', e => {
      e.preventDefault();
      const newTask = taskInput.value.trim();
      if (newTask.length > 0) {
        tasks.push(newTask);
        saveTasks();
        renderTasks();
        taskInput.value = '';
      }
    });

    // Initialization
    function init() {
      updateUI();
      updateManHoursDisplay();
      renderTasks();
      setBackgroundColor(bgSelect.value);
    }

    init();
  })();
</script>
</body>
</html>
